# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id: Portfile $

PortSystem          1.0
PortGroup           github 1.0

name                arcanist
subport             libphutil {}

if {${subport} eq ${name}} {
    github.setup    phacility ${subport} 737f5c0df976fe2b3178aac6ab7feb3d3621d99e
    version         20160409
    depends_run-append \
                    port:libphutil
    description     Phabricator command-line tool
    long_description \
                    Arcanist is the command-line tool for Phabricator (http://phabricator.org). \
                    It allows you to interact with Phabricator installs to send code for review, \
                    download patches, transfer files, view status, make API calls, and various other \
                    things.
    checksums       rmd160  e286b57e58aa8724e4102675c817492c2953cfc1 \
                    sha256  e4f0b1db94ae9ac933fc3437a8e5ce5a3f80e818b6fa0c2457dc1789d0dba007
} else {
    github.setup    phacility ${subport} 7a184448aff55465476da0e13477b7e6f3446a14
    # github.set will have overriden our name, reset it:
    name            arcanist
    version         20160414
    description     A collection of utility classes and functions for PHP
    long_description \
                    ${description}.
    checksums       rmd160  fe653def81c2b06e72d0043f8c9711981fb44d56 \
                    sha256  d0d4669888f03fe5028ebb1e921651a4d07aa5efa73602d888f515c5529aae65
}

categories          devel
license             Apache-2
maintainers         gmail.com:rjvbertin
supported_archs     noarch

platform darwin {
    depends_run-append \
                    port:php
}

use_configure       no

build               {}

ui_msg "${name} ${subport}"
destroot {
    xinstall -m 755 -d ${destroot}${prefix}/libexec
    system "cp -pR ${worksrcpath} ${destroot}${prefix}/libexec/${subport}"
    if {${subport} eq "${name}"} {
        ln -s ${prefix}/libexec/${subport}/bin/arc ${destroot}${prefix}/bin/arc
    }
}
