# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           cmake 1.1
PortGroup           LTO 1.0

name                copperspice
version             1.6.3
# find a clever way to set BUILD_DATE so it has more meaning than a fixed-by-the-port value
# but still doesn't interfere with ccache (maintainer convenience)
set BUILD_DATE      2020-07-11
categories          devel
platforms           darwin linux
maintainers         gmail.com:rjvbertin openmaintainer
license             LGPL-2.1

description         a cross-platform middleware derived and diverged from Qt

long_description    CopperSpice is a set of individual libraries which can be used to develop cross \
                    platform software applications in C++. It is a totally open source project that \
                    was initially derived from the Qt framework. Over the last several years CopperSpice \
                    has completely diverged, with a goal of providing a first class GUI library to unite \
                    the C++ community. 

master_sites        https://download.copperspice.com/${name}/source/
use_bzip2           yes
checksums           rmd160  4909ee0c88967f64974c0662d36270d1a69adf20 \
                    sha256  e207fcb58fbb0a6ca0fd9c3befdb1553a4e6a9a19c08e21ccf377bf3ce824508
#                     size    16804699

pre-extract {
    # CopperSpice doesn't properly pack their tarballs
    xinstall -m 755 -d ${worksrcpath}
    extract.post_args-append \
                    -C ${worksrcpath}
}

patch.pre_args      -Np1
patchfiles-append   patch-macports-build.diff

cmake.save_configure_cmd "log too"

configure.env-append \
                    "ICONVDIR=${prefix}"

configure.args-append \
                    -DBUILD_DATE="${BUILD_DATE}" \
                    -DCMAKE_INSTALL_BINDIR=libexec/CopperSpice/bin \
                    -DCMAKE_INSTALL_INCLUDEDIR=include/CopperSpice

