# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           qmake5 1.0

name                qt5-assistant
set module          qttools
version             5.9.2

set branch          [join [lrange [split ${version} .] 0 1] .]

categories          devel aqua
description         A standalone version of Qt's Assistant
long_description    Qt Assistant is the documentation browser from the QtTools component. \
                    Its full feature set and optimum rendering depends on the now deprecated \
                    QtWebKit component.
universal_variant   no

maintainers         gmail.com:rjvbertin mk openmaintainer
platforms           darwin linux
license             LGPL-3

homepage            http://qt.io
distname            ${module}-opensource-src-${version}
master_sites        http://download.qt.io/official_releases/qt/${branch}/${version}/submodules

checksums           rmd160  3b072a3225c5a4c796a9406232c3f696285d9aa4 \
                    sha256  27cbac45c786b1718550a87e6f86010e161302b426c6396ff2a3091b913b17dd

# a convenience procedure to register conflicts among the different Qt5 ports:
# for instance: [qt5_port_conflicts {qtbase x11}]
# adapted from port:qt5-kde
proc qt5_port_conflicts {components} {
    global available_qt5_versions subport
    set cnfls {}
    foreach suffix {"" "-devel"} {
        foreach comp ${components} {
            foreach v ${available_qt5_versions} {
                if {"${v}-${comp}" ne "${subport}"} {
                    if {${comp} ne "" && ${comp} ne "qtbase"} {
                        set cnfls [lappend cnfls ${v}-${comp}]
                        set cnfls [lappend cnfls ${v}-kde${suffix}-${comp}]
                    } else {
                        set cnfls [lappend cnfls ${v}-qtbase]
                        set cnfls [lappend cnfls ${v}-kde${suffix}]
                    }
                }
            }
        }
    }
    return ${cnfls}
}

conflicts-append    [qt5_port_conflicts assistant] ${name}-devel

qt5.depends_component \
                    qttools qtwebkit

patch.pre_args      -Np1

patchfiles-append   patch-qttools-assistant-standalone-build.diff \
                    patch-assistant-fontpanel.diff

