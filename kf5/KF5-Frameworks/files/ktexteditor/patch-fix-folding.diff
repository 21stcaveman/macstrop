commit c004f3f787b2b6fd8a1c82a66410f5cb39febf18
Author: Christoph Cullmann <cullmann@kde.org>
Date:   Sat Dec 29 17:36:33 2018 +0100

    c004f3f787b2b6fd8a1c82a66410f5cb39febf18 no longer reverted
    RJVB: also catch a condition that has been known to cause crashes.

diff --git src/syntax/katehighlight.cpp src/syntax/katehighlight.cpp
index 064a601bab2e148da235c37d7b8e36f6331a66cc..193630a7f69b2eb63f01848636351ea58b27b41d 100644
--- src/syntax/katehighlight.cpp
+++ src/syntax/katehighlight.cpp
@@ -275,6 +275,10 @@ void KateHighlighting::applyFormat(int offset, int length, const KSyntaxHighligh
     // get internal attribute, must exist
     const auto it = m_formatsIdToIndex.find(format.id());
     Q_ASSERT(it != m_formatsIdToIndex.end());
+    if (it == m_formatsIdToIndex.end()) {
+        qWarning() << Q_FUNC_INFO << "found invalid attribute index for" << format.id() << "and text" << m_textLineToHighlight->text();
+        return;
+    }
 
     // remember highlighting info in our textline
     m_textLineToHighlight->addAttribute(Kate::TextLineData::Attribute(offset, length, it->second));
