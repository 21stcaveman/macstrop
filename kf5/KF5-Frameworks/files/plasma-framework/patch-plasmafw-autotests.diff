diff --git autotests/CMakeLists.txt autotests/CMakeLists.txt
index a848182..52a7e8e 100644
--- autotests/CMakeLists.txt
+++ autotests/CMakeLists.txt
@@ -5,6 +5,7 @@ set(EXECUTABLE_OUTPUT_PATH ${CMAKE_CURRENT_BINARY_DIR})
 
 include(ECMMarkAsTest)
 include(ECMAddTests)
+include(ECMMarkNonGuiExecutable)
 
 find_package(KF5CoreAddons REQUIRED)
 find_package(KF5XmlGui REQUIRED)
@@ -21,6 +22,7 @@ endif()
 MACRO(PLASMA_UNIT_TESTS)
        FOREACH(_testname ${ARGN})
                add_executable(${_testname} ${_testname}.cpp)
+               ecm_mark_nongui_executable(${_testname})
                target_link_libraries(${_testname} Qt5::Qml Qt5::Test
                                      KF5::Plasma KF5::PlasmaQuick
                                      KF5::Archive KF5::CoreAddons
@@ -47,6 +47,7 @@
 )
 
 add_executable(storagetest storagetest.cpp ../src/plasma/private/storage.cpp ../src/plasma/private/storagethread.cpp ../src/plasma/debug_p.cpp)
+ecm_mark_nongui_executable(storagetest)
 target_link_libraries(storagetest Qt5::Gui Qt5::Test Qt5::Sql KF5::KIOCore KF5::Plasma KF5::CoreAddons)
 
 if(HAVE_X11)
@@ -66,6 +69,7 @@ add_executable(sortfiltermodeltest
     ../src/declarativeimports/core/datamodel.cpp
     ../src/declarativeimports/core/datasource.cpp
     )
+ecm_mark_nongui_executable(sortfiltermodeltest)
 
 target_link_libraries(sortfiltermodeltest
     KF5::Plasma
