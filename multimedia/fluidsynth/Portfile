# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                fluidsynth
version             1.1.6
revision            2
categories          multimedia
maintainers         gmail.com:rjvbertin mojca openmaintainer
license             LGPL

description         FluidSynth is a real-time software synthesizer based on the SoundFont 2 specifications.
long_description    FluidSynth is a real-time software synthesizer based on the SoundFont 2 specifications.

platforms           darwin

homepage            http://fluidsynth.sourceforge.net/
master_sites        sourceforge:project/${name}/${name}-${version}

checksums           rmd160  27b17e1e097004dd3cf8fb88d8e4499eeb339ea8 \
                    sha256  d28b47dfbf7f8e426902ae7fa2981d821fbf84f41da9e1b85be933d2d748f601

subport fluid-soundfont-gm {
    description     SoundFont definitions for FluidSynth
    long_description \
                    ${description}. Provides the Fluid (R3) General Midi Level 1 \
                    SoundFont (GM).
    license         MIT
    set orig_version \
                    3.1
    version         ${orig_version}.5.1
    homepage        https://sourceforge.net/p/fluidsynth/wiki/SoundFont/
    distname        fluid-soundfont_${orig_version}
    extract.suffix  .orig.tar.gz
    worksrcdir      fluid-soundfont-${orig_version}
    master_sites    http://http.debian.net/debian/pool/main/f/fluid-soundfont/
    checksums       rmd160  edd3d626bd1fe17c18f1ddf0b657f54d02fd8b5a \
                    sha256  2621acaa1c78e4abdb24bdd163230cc577e61276936d6aa6e3180582142f0343

    patch.pre_args  -Np1
    # the debian patch that creates the soundfont .cfg definition
    patchfiles-append \
                    fluid-soundfont_3.1-5.1.diff
    use_configure   no
    build           {}
    destroot {
        xinstall -m 755 -d ${destroot}${prefix}/share/docs/fluidsynth/Fluid-GM-R3
        xinstall -m 644 ${worksrcpath}/README ${destroot}${prefix}/share/docs/fluidsynth/Fluid-GM-R3
    }
}

subport fluid-soundfont-gs {
    description     SoundFont definitions for FluidSynth
    long_description \
                    ${description}. Provides the GeneralUser SoundFont by S. Christian Collins (GS).
    homepage        https://sourceforge.net/p/fluidsynth/wiki/SoundFont/
}

if {${subport} eq "${name}"} {
    use_bzip2       yes
    depends_build   port:pkgconfig
    depends_lib     port:flac \
                    port:gettext \
                    path:lib/pkgconfig/glib-2.0.pc:glib2 \
                    port:jack \
                    port:libiconv \
                    port:libogg \
                    port:libsndfile \
                    port:libvorbis \
                    port:ncurses \
                    port:portaudio \
                    port:readline

    configure.args  --disable-pulse-support

    livecheck.type  sourceforge
    livecheck.regex /${name}-(\[0-9.\]+)${extract.suffix}
}
